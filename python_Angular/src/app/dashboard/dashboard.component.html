<div class="dash-layout">
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="logo-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M3 3h7v7H3zM14 3h7v7h-7zM3 14h7v7H3zM14 14l3.5 3.5L21 14l-3.5-3.5L14 14z" stroke="currentColor"
            stroke-width="1.5" stroke-linejoin="round" />
        </svg>
      </div>
      <span>DataPulse</span>
    </div>

    <nav class="sidebar-nav">
      <a class="nav-item active">Dashboard</a>
      <a class="nav-item" (click)="goToUpload()">Nouveau fichier</a>
    </nav>

    <div class="sidebar-user">
      <div class="user-avatar">{{ (username || 'U')[0].toUpperCase() }}</div>
      <div class="user-info">
        <span class="user-name">{{ username }}</span>
      </div>
      <button class="logout-btn" (click)="logout()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9" stroke="currentColor" stroke-width="1.5"
            stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </div>
  </aside>

  <main class="dash-main">
    <header class="dash-header">
      <div>
        <h1>Tableau de bord</h1>
        <p>Gérez et analysez vos données</p>
      </div>
      <button class="btn-new" (click)="goToUpload()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
        Nouveau fichier
      </button>
    </header>

    <div class="stats-row">
      <div class="stat-tile">
        <div class="stat-num">{{ stats.total_files || 0 }}</div>
        <div class="stat-lbl">Fichiers traités</div>
      </div>
      <div class="stat-tile">
        <div class="stat-num">{{ stats.total_rows || 0 }}</div>
        <div class="stat-lbl">Lignes analysées</div>
      </div>
    </div>

    <section class="files-section">
      <div class="section-header">
        <h2>Historique des fichiers</h2>
      </div>

      <div *ngIf="files.length === 0" class="empty-state">
        <p>Aucun fichier traité pour le moment</p>
      </div>

      <div *ngIf="files.length > 0" class="table-wrap">
        <table class="files-table">
          <thead>
            <tr>
              <th>Fichier</th>
              <th>Date</th>
              <th>Lignes</th>
              <th>Colonnes</th>
              <th>Statut</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let file of files">
              <td>
                <div class="file-cell">
                  <span class="file-ext">{{ getExt(file.filename) }}</span>
                  <span class="file-name">{{ file.filename }}</span>
                </div>
              </td>
              <td>{{ file.upload_date | date:'shortDate' }}</td>
              <td>{{ file.rows }}</td>
              <td>{{ file.columns }}</td>
              <td><span class="badge-status">Traité</span></td>
              <td>
                <button class="btn-delete" (click)="deleteFile(file.filename)">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                    <path d="M19 6l-1 14H6L5 6M10 11v6M14 11v6M9 6V4h6v2" stroke="currentColor" stroke-width="1.5"
                      stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>
</div>